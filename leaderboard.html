<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>
<body onload="displayLeaderboard()">
    <!-- Start Here -->
    <h1 class="w-50 p-3">Leaderboard</h1>

    <table class="table">
        <thead class="thead-dark">
            <tr>
                <th scope="col">Rank</th>
                <th scope="col">Name</th>
                <th scope="col">Total Completion Time</th>
            </tr>
        </thead>
        <tbody>
            <tr id="first">
                <td style="color:gold;font-weight: bold;">1st</td>
                <td id="first-name">Name 1</td>
                <td id="first-total-time">Time 1</td>
            </tr>

            <tr id="second">
                <td style="color:silver;font-weight: bold;">2nd</td>
                <td id="second-name">Name 2</td>
                <td id="second-total-time">Time 2</td>
            </tr>

            <tr id="third">
                <td style="color:orangered;font-weight: bold;">3rd</td>
                <td id="third-name">Name 3</td>
                <td id="third-total-time">Time 3</td>
            </tr>

            <tr id="fourth">
                <td>4th</td>
                <td id="fourth-name">Name 4</td>
                <td id="fourth-total-time">Time 4</td>
            </tr>

            <tr id="fifth">
                <td>5th</td>
                <td id="fifth-name">Name 5</td>
                <td id="fifth-total-time">Time 5</td>
            </tr>
        </tbody>
    </table>
    
    <script>
        // *****CODE FOR NEEDED CLASS DECLARATION BELONGS HERE*****
        // int pk: primary key (child)
        // int ppk: primary key (parent)
        // int time: (in deciseconds)
        // String when: (date it was achieved)
        class Score {
            constructor(pk, ppk, time, when) {
                this.pk = pk
                this.ppk = ppk
                this.time = time
                this.when = when
            }
        }

        // int pk: primary key
        // String name: 
        // int[] pkChildList: An int array that contains the primary key of all 3 scores
        // int[] childTimeList: An integer array containing the completion time of all 3 scores
        // String[] childWhenList: A string array containing when each level was finished
        class Player {
            constructor(pk, name, pkChildList, childTimeList, childWhenList) {
                this.pk = pk
                this.name = name
                this.Scr1 = new Score(pkChildList[0], this.pk, childTimeList[0], childWhenList[0])
                this.Scr2 = new Score(pkChildList[1], this.pk, childTimeList[1], childWhenList[1])
                this.Scr3 = new Score(pkChildList[2], this.pk, childTimeList[2], childWhenList[2])
            }
            
            // Returns an integer sum of all 3 level times
            getTotalTime() {
                return this.Scr1.time + this.Scr2.time + this.Scr3.time
            }
            
            // Returns the difference in total time between this player and another player
            compareTimes(otherPlayer) {
                return this.getTotalTime() - otherPlayer.getTotalTime()
            }
        }




        // *****CODE FOR LEADERBOARD FUNCTIONALITY BELONGS HERE*****

        // Data from the API should be inserted here
        // It's currently being initialized but if data is properly fed from the API, then the leaderboard should still work (hopefully)
        // Note that they should be sorted prior
        // The whole point of this is so that the website will call the displayLeaderboard() function onload and just grab the data from here
        // NOTE: All data arrays have to have the SAME LENGTH

        // Data for Players here
        let player_pk_list = [1, // 1st entry
                              2, // 2nd entry
                              3, // 3rd entry
                              4, // ... (you get the point)
                              5, 
                              6, 
                              7]
        let player_name_list = ["Abby",     // 1st entry
                                "Bart",     // 2nd entry
                                "Candice",  // ...
                                "Danny", 
                                "Ellie", 
                                "Frank", 
                                "George"]
        
        // Data for Scores here
        // For each value in score_data_list, it's organized in a way such that:
            // 1st index: primary keys of all 3 score children
            // 2nd index: completion time of all 3 scores
            // 3rd index: when each level was completed (in a string)

        let score_data_list = [[[101, 102, 103], [10, 10, 10], ["mon", "tue", "wed"]], // 1st entry
                               [[201, 202, 203], [10, 20, 10], ["mon", "tue", "wed"]], //2nd entry
                               [[301, 302, 303], [10, 20, 20], ["mon", "tue", "wed"]], // ...
                               [[401, 402, 403], [10, 30, 30], ["mon", "tue", "wed"]], 
                               [[501, 502, 503], [10, 40, 30], ["mon", "tue", "wed"]], 
                               [[601, 602, 603], [20, 40, 30], ["mon", "tue", "wed"]], 
                               [[701, 702, 703], [20, 40, 40], ["mon", "tue", "wed"]]]




        // Called whenever the leaderboard is opened
        // Simply displays the leaderboard as the name says
        function displayLeaderboard() {
            // Initializes all Player objects based on the data
            // NOTE: All data arrays have to have the SAME LENGTH
            let curr_players = []

            for(let i = 0; i < player_pk_list.length; i++) {
                let currPlayer = new Player(player_pk_list[i], player_name_list[i], score_data_list[i][0], score_data_list[i][1], score_data_list[i][2])
                curr_players.push(currPlayer)

                // Only adds players to the leaderboard so long as they have finished all 3 levels
                // if(currPlayer.finishedGame() === true) {
                //     curr_players.push(currPlayer);
                // }
            }



            // We then officially update the leaderboard based on the data given prior

            // Update 1st place
            document.getElementById("first-name").innerHTML=curr_players[0].name;
            document.getElementById("first-total-time").innerHTML=curr_players[0].getTotalTime();

            // Update 2nd place
            document.getElementById("second-name").innerHTML=curr_players[1].name;
            document.getElementById("second-total-time").innerHTML=curr_players[1].getTotalTime();

            // Update 3rd place
            document.getElementById("third-name").innerHTML=curr_players[2].name;
            document.getElementById("third-total-time").innerHTML=curr_players[2].getTotalTime();

            // Update 4th place
            document.getElementById("fourth-name").innerHTML=curr_players[3].name;
            document.getElementById("fourth-total-time").innerHTML=curr_players[3].getTotalTime();

            // Update 5th place
            document.getElementById("fifth-name").innerHTML=curr_players[4].name;
            document.getElementById("fifth-total-time").innerHTML=curr_players[4].getTotalTime();
        }
    </script>
    
    
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>
</html>